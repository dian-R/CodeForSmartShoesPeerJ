# Code for the smart shoe paper
This repository contains:
1) a program processing raw data, running the random forest training-evaluation treatment and storing the results of the smart shoe project.
2) a notebook for generating figure panels included in the manuscript.


## Content of the repository
* **automatedAnalysis.py** - This program contains a library of functions reading the raw data, extracting features, performing the machine learning treatment (training, evaluation), and storing the results. It automatically manages the feature reduction stepping process and can evaluate multiple sensor configurations, up to the maximum number of threads available. It also automatically manages evaluating performance of multiple window size from 1 second to 60 seconds with full sensor configuration full available features.
* **FigurePanels.ipynb** - This Jupyter notebook contains functions and pieces of code for generating the figure panels showed in the manuscript. The output of **automatedAnalysis.py** are used as inputs. The generation of fig.9B panels used a different set of inputs, also provided in the data repository.

## Prerequisites
Python 3 (>= 3.6)

Jupyter notebook

Packages: Numpy, Pandas, Scipy, Sklearn, pickle, import heapq, time, seaborn, multiprocessing, psutil, sys, os, glob

## Getting Start
* Clone the repository in /DIR
* Clone the raw foot pressure data ("FootPressureRawData") from the data repository in /DIR
* Prepare two folders:
1) /DIR/window_length_results/ for storing the results of the "window length" analysis
2) /DIR/config_feat_results/ for storing the results of the "sensor configuration and feature number reduction" analysis.
* Run the code in the terminal from the directory of **automatedAnalysis.py** with following command to get results of the "window length" analysis.(Example for Linux users.)
```bash
python3 automatedAnalysis.py /DIR/FootPressureRawData/ /DIR/window_length_results/ 
```
* Run the code in the terminal from the directory of **automatedAnalysis.py** with following command to get results of the "sensor configuration and feature number reduction" analysis when using 20 seconds of window size.(Example for Linux users.)
```bash
python3 automatedAnalysis.py /DIR/FootPressureRawData/ /DIR/config_feat_results/ 2000
```
* You can run **FigurePanels.ipynb** in jupyter notebook to generate figure panels.
Note: Single forest results are not stored by **automatedAnalysis.py** in main analysis. For the sake of examples shown in Figure 11, detailed single forest performance statistics have been generated separetely. These results are available in the data repository ("one_config").
* Supplementary results of "sensor configuration and feature number reduction of other window size" can be generated by changing the "Window_Length" into the interest window length. Note that since the data frequency was 100 Hz, therefore, the input number of window length has to be motiplied by 100. For example, 1-sec, the "Window_Length" should be replaced by 100. "Configuration_number" can be replaced with number: 25 or 127. If replaced with 25, the out put will be only results for 25 representive configurations in the paper, this will increase running speed. If replaced with 127, the out put will be results for all available configurations the smart shoes can get. If neither running speed nor all configurations are requested, please delet "Configuration_number", the out put will be 67 defulted configurations in the paper.
```bash
python3 automatedAnalysis.py /DIR/FootPressureRawData/ /DIR/config_feat_results/ Window_Length Configuration_number
```

